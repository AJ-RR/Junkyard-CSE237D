#!/bin/bash
set -e

# Config
URL="https://smartcycling.sysnet.ucsd.edu/gradescope/submit"  # Replace with actual server URL if needed
ZIP_FILE="/tmp/submission.zip"
RESULTS_JSON="/autograder/results/results.json"

STUDENT_NAME=$(jq -r '.users[0].name' "$METADATA_FILE")
ASSIGNMENT_TITLE=$(jq -r '.assignment.title' "$METADATA_FILE")

# Zip the submission
cd "$SUBMISSION_DIR"
zip -r "$ZIP_FILE" ./*
cd -

# Make POST request
curl -X POST "$URL" \
  -F "name=$NAME" \
  -F "image=$IMAGE" \
  -F "script=@$ZIP_FILE" \
  -H "Content-Type: multipart/form-data" \
  -o "$RESULTS_JSON"

# Output saved location
echo "Response written to $RESULTS_JSON"

